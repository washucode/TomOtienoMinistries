# Rev. Tom Otieno Ministry Website

## Overview

This is a full-stack web application for Rev. Tom Otieno's healing and deliverance ministry. The platform enables visitors to explore ministry programs, watch sermon videos, register for events, and learn about spiritual teachings. The website features a modern, elegant design with a focus on user engagement through video content, event registrations, and ministry information.

## User Preferences

Preferred communication style: Simple, everyday language.

## System Architecture

### Technology Stack

**Frontend:**
- React 18 with TypeScript for type-safe component development
- Vite as the build tool and development server
- Wouter for lightweight client-side routing
- TanStack Query (React Query) for server state management
- Framer Motion for animations and transitions
- Tailwind CSS v4 with shadcn/ui component library for styling
- Custom theme with royal blue color scheme and serif/sans-serif font pairing

**Backend:**
- Express.js server running on Node.js
- RESTful API architecture
- Drizzle ORM for database operations
- Neon PostgreSQL as the database provider
- Nodemailer for email notifications (Gmail SMTP)

**Build System:**
- TypeScript compilation for both client and server
- ESBuild for server bundling with selective dependency bundling
- Vite for client bundling with HMR support
- Monorepo structure with shared schema definitions

### Database Schema

The application uses PostgreSQL with four main tables:

1. **users** - Admin authentication (username/password)
2. **videos** - YouTube video metadata (title, videoId, category, thumbnail, duration, views)
3. **registrations** - Ministry program registrations (ministryType, fullName, email, phone, message)
4. **ministrySettings** - Dynamic configuration for ministry programs (status, dates, capacity, current registrations)

All tables use UUID primary keys generated by PostgreSQL. The schema is defined in `shared/schema.ts` using Drizzle ORM with Zod validation schemas.

### API Architecture

**RESTful Endpoints:**
- `GET /api/videos` - Fetch all videos
- `POST /api/videos` - Create new video (admin)
- `PUT /api/videos/:id` - Update video (admin)
- `DELETE /api/videos/:id` - Delete video (admin)
- `GET /api/registrations` - Fetch all registrations (admin)
- `GET /api/registrations/:ministryType` - Fetch registrations by ministry type
- `POST /api/registrations` - Submit registration (triggers email notification)
- `PUT /api/registrations/:id` - Update registration details (admin)
- `DELETE /api/registrations/:id` - Delete registration (admin)
- `GET /api/ministry-settings` - Fetch all ministry settings
- `GET /api/ministry-settings/:ministryType` - Fetch specific ministry settings
- `POST /api/ministry-settings` - Upsert ministry settings (admin)

All requests use JSON payloads with Zod validation on the server side.

### Frontend Architecture

**Component Structure:**
- Page components: Home, Videos, Admin, NotFound
- Feature components: Hero, Navbar, Footer, Ministries, Sermons, Proskuneo, Book
- UI components from shadcn/ui (buttons, dialogs, forms, cards, etc.)

**State Management:**
- React Query for server state (videos, registrations, ministry settings)
- Local React state for UI interactions (modals, forms)
- No global state management library needed

**Routing:**
- Client-side routing with Wouter
- Routes: `/` (Home), `/videos` (Video Archive), `/admin` (Dashboard)
- Hash-based navigation for same-page sections (#ministries, #proskuneo, etc.)

### Email Notification System

The application sends registration confirmations via Gmail SMTP:
- Configured through environment variables (GMAIL_USER, GMAIL_APP_PASSWORD)
- Sends notifications for ministry registrations to admin
- Gracefully handles missing configuration without breaking registration flow

### Development vs Production

**Development Mode:**
- Vite dev server on port 5000
- Express server with hot reload via tsx
- Replit-specific plugins (cartographer, dev-banner) for enhanced DX
- Separate client and server processes

**Production Mode:**
- Single bundled Express server serving static files
- Client built to `dist/public` directory
- Server bundled to `dist/index.cjs` with selective dependencies
- Optimized for fast cold starts on serverless platforms

### Asset Management

**Static Assets:**
- Images stored in `attached_assets` directory
- Logo and hero images referenced directly
- Generated images for book covers and backgrounds
- Favicon and OpenGraph images in `client/public`

**Custom Vite Plugin:**
- `vite-plugin-meta-images.ts` automatically updates OpenGraph meta tags
- Detects Replit deployment URLs and updates image paths accordingly

### Authentication

Current implementation includes user table structure but no active authentication system. The admin routes are currently unprotected, suggesting authentication is planned but not yet implemented.

### Admin Dashboard Features

**Full Admin Panel:**
- Video Management: Add, edit, delete sermon/teaching videos
- Registration Management: View, edit, and delete ministry registrations
- Ministry Settings: View and edit program status, dates, location, and capacity
- Real-time Dashboard Stats: Video count, registration count, active/upcoming programs
- Registration Count Tracking: Automatic increment/decrement with add/delete operations

**Podcast/Spotify Integration:**
- Status: Fully implemented with admin panel management
- Admin Panel: Go to Admin > Podcast tab to add Spotify Show ID and RSS URL
- Homepage: Podcast section displays Spotify embed player when Show ID is configured
- RSS URL: Field is available for future podcast feed integration
- Storage: Uses site_settings table for global podcast configuration

### Build Process

**Build Steps:**
1. Clean `dist` directory
2. Build client with Vite (outputs to `dist/public`)
3. Build server with ESBuild (outputs to `dist/index.cjs`)
4. Bundle allowlisted dependencies to reduce syscalls
5. External dependencies remain in node_modules

**Database Migrations:**
- Drizzle Kit manages schema changes
- Migration files stored in `migrations` directory
- Push schema changes with `npm run db:push`

## External Dependencies

### Database
- **Neon PostgreSQL** - Serverless Postgres database
- Connection via `@neondatabase/serverless` driver
- Requires `DATABASE_URL` environment variable

### Email Service
- **Gmail SMTP** - Email delivery via Nodemailer
- Requires `GMAIL_USER` and `GMAIL_APP_PASSWORD` environment variables
- Used for registration notifications

### Third-Party Services
- **YouTube** - Video hosting (videos embedded via YouTube IDs)
- **Unsplash** - Stock images for placeholders and thumbnails
- **Google Fonts** - Cormorant Garamond and Montserrat fonts

### UI Component Library
- **shadcn/ui** - Pre-built accessible components based on Radix UI
- **Radix UI** - Headless UI primitives (dialogs, dropdowns, etc.)
- **Lucide React** - Icon library
- **Tailwind CSS** - Utility-first CSS framework

### Development Tools
- **Replit Plugins** - Development banner, error overlay, cartographer
- **ESBuild** - Fast JavaScript bundler
- **Vite** - Next-generation frontend tooling
- **Drizzle Kit** - Database migration tool